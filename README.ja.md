[English](README.md) | [中文](README.zh.md) | [日本語](README.ja.md)

# Fantia ダウンローダーとは

[ファンティア[Fantia]](https://fantia.jp/) は、イラスト・漫画・小説・コスプレ・音楽・映像作品など、各方面で活躍されているクリエイターの皆さまを応援する、クリエイター支援プラットフォームです。

指定された 投稿ID から開始し、その投稿内のすべてのメディアファイル（画像・動画）を自動的にダウンロードし、設定に応じて前後の投稿へと自動遷移できます。

> ⚠️ 本ツールは GUI（ブラウザ画面）での使用を前提に設計されており、Puppeteer によってユーザーの操作をシミュレートします。API のみを使用した実行には対応していません。

# 動作環境

- [Node.js](https://nodejs.org) をインストールしてください
- [Yarn](https://classic.yarnpkg.com/en/docs/install/) パッケージマネージャーをインストール（または `npm` を使用）

# 使い方

1. `.env.example` を `.env` にコピーし、必要な設定値を記入します。
2. `yarn install`（または `npm install`）を実行して依存パッケージをインストールします。
3. `node index_JP.js` を実行してプログラムを起動します。
4. CLI に従って、最初にダウンロードしたい 投稿ID を入力してください。

Fantia の URL から 投稿ID を取得できます：  
例：`https://fantia.jp/posts/123456` → ID = `123456`

投稿ごとに一定のクールダウンがあり、アクセス制限を回避します。

# 環境変数の説明

## DOWNLOAD_PATH

ダウンロードしたファイルの保存先を指定します。  
相対パスまたは絶対パスを使用できます。

## SESSION_ID

Puppeteer でログインする場合は設定不要です。

## BLOCK_KEYWORDS

タイトルに指定したキーワードが含まれている投稿をスキップします。  
例：  
`BLOCK_KEYWORDS=test,draft,noaudio`

## BLOCK_FILENAME_KEYWORDS

ファイル名に指定キーワードが含まれている画像・動画をスキップします。  
キーワードはカンマで区切って指定します。

## DIRECTION

ダウンロードする投稿の進行方向を指定します：

- `forward` – 次の投稿へ進みます（新しい順）
- `backward` – 前の投稿へ戻ります（古い順）
- `once` – 現在の投稿のみダウンロードして終了

## USE_IDM

Internet Download Manager (IDM) を使用するかどうかを指定します。  
`true` に設定すると IDM を呼び出してダウンロードします。

## IDM_PATH

`IDMan.exe` へのフルパスを指定します。

# スクリプト機能

- 投稿の自動遷移（forward / backward / once をサポート）
  - `forward`：同じクリエイターの新しい投稿へ移動
  - `backward`：同じクリエイターの過去の投稿へ移動
  - `once`：現在の投稿のみをダウンロード
- ダウンロード進行状況とファイルサイズの表示
- 各投稿の `post.json` メタデータを保存
- 既に存在するファイルはスキップ
- タイトルやファイル名に基づくキーワードフィルタリング
- Puppeteer を使ったブラウザログイン・Cookie 保存に対応
- ダウンロード完了後、設定に基づき次の投稿へ遷移

# Windows におけるファイル名の禁止文字

Windows のファイル名では以下の文字は使用できないため、自動的に `+` に置き換えられます：

`/`, `\\`, `?`, `%`, `*`, `:`, `|`, `"`, `<`, `>`

# ライセンス

MIT License
